# Implementation Plan: Log Viewer

**Branch**: `007-log-viewer` | **Date**: 2026-02-12 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/007-log-viewer/spec.md`

## Summary

Implement a real-time webhook log viewer with a PrimeVue DataTable showing log entries per endpoint and across all endpoints. Log details are shown via expandable inline rows displaying request/response side by side with JSON syntax highlighting. The system uses Supabase Realtime for live updates and traditional numbered pagination.

## Technical Context

**Language/Version**: JavaScript (ES modules), Vue 3 Composition API
**Primary Dependencies**: Vue 3, PrimeVue 4 (DataTable, Column, Tag, Paginator), Pinia, Supabase JS Client
**Storage**: Supabase PostgreSQL (existing `webhook_logs` table — no schema changes needed)
**Testing**: Vitest + @vue/test-utils
**Target Platform**: Web browser (SPA on Vercel)
**Project Type**: Web application (Vue SPA + Vercel Serverless Functions)
**Performance Goals**: Log entries appear within 1 second of insertion; 100+ rows render smoothly
**Constraints**: 24h log retention; 55s max timeout; browser-based relay architecture
**Scale/Scope**: Single-user per session; logs bounded by 24h retention policy

## Constitution Check

_GATE: Must pass before Phase 0 research. Re-check after Phase 1 design._

| Principle                          | Status | Notes                                                                                                          |
| ---------------------------------- | ------ | -------------------------------------------------------------------------------------------------------------- |
| I. Plain JavaScript, No Exceptions | PASS   | All code is plain JS with Vue 3 `<script setup>`                                                               |
| II. Browser-as-Bridge              | PASS   | Log viewer is a read-only display layer; relay remains browser-based                                           |
| III. Full HTTP Fidelity            | PASS   | Headers and bodies displayed exactly as stored; no transformation                                              |
| IV. Meaningful Testing             | PASS   | Tests cover store logic, composables, and component behavior; no PrimeVue internals or Tailwind classes tested |
| V. Simplicity & Minimal Scope      | PASS   | Feature serves the core purpose (observability of relayed webhooks); no unnecessary abstractions               |

## Project Structure

### Documentation (this feature)

```text
specs/007-log-viewer/
├── plan.md              # This file
├── research.md          # Phase 0 output
├── data-model.md        # Phase 1 output
├── quickstart.md        # Phase 1 output
├── contracts/
│   └── logs-api.md      # Phase 1 output
└── tasks.md             # Phase 2 output (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
api/
├── logs/
│   ├── index.js             # GET /api/logs (list with filters + pagination)
│   └── [id].js              # GET /api/logs/:id (single log detail)
└── _lib/                    # Existing shared helpers (auth, cors, supabase)

src/
├── components/
│   └── logs/
│       ├── LogList.vue          # DataTable with expandable rows, status badges
│       ├── LogDetail.vue        # Expanded row: request/response side by side
│       └── PayloadViewer.vue    # Reusable JSON/text viewer with pretty/raw toggle
├── composables/
│   └── use-logs.js              # Thin wrapper around logs store
├── stores/
│   └── logs.js                  # Pinia store: fetch, pagination, Realtime subscription
├── views/
│   └── LogsView.vue             # Combined "All Logs" view (US3)
└── router/
    └── index.js                 # Add /logs route + update endpoint detail

tests/
└── unit/
    ├── stores/
    │   └── logs.test.js         # Store unit tests
    ├── composables/
    │   └── use-logs.test.js     # Composable tests
    └── components/
        └── PayloadViewer.test.js  # JSON detection, truncation, toggle
```

**Structure Decision**: Follows existing project conventions. New files are added within the established `api/`, `src/components/`, `src/stores/`, `src/composables/`, `src/views/`, and `tests/` directories. No new top-level directories needed.

## Complexity Tracking

No constitution violations. This table is intentionally empty.

| Violation | Why Needed | Simpler Alternative Rejected Because |
| --------- | ---------- | ------------------------------------ |
| (none)    | —          | —                                    |
